---
title: "事件与状态"
lang: "zh-hans"
---

本文介绍收款、退款和出金/转账过程中涉及到的所有 Webhook 事件以及状态变更流程。

## Webhook 事件

**1. 入账相关 **

| 功能场景 | 事件名称                                     | 触发条件                                                                                                                                                                                              | 事件内容                                                                                                                                                                                                                                                                                                                                                                                   |
| ---- | ---------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 订单模式 | `payment.order.status.updated`           | 支付订单状态发生变更，会触发的节点包括：<br />- `Pending`: 此状态通知仅限于通过支付链接成功创建订单时触发。<br />- `Completed`: 在订单有效期内收到全额付款。<br />- `Expired`: 订单有效期内没有已完成的充币交易，或者订单已被取消。<br />- `Underpaid`: 订单有效期内存在已完成的充币交易，但实收金额少于应付金额。 | 请参考 [Get pay-in order information](/payments/en/api-references/payment/get-pay-in-order-information) 的响应参数说明。                                                                                                                                                                                                                                                                          |
|      | `payment.transaction.late`               | 在支付订单已处于终态（`Underpaid`、`Expired` 或 `Completed`）后又收到一笔通过合规扫描的充币交易。                                                                                                                                 | 该数据结构包含了 [Get transaction information](https://www.cobo.com/developers/v2/api-references/transactions/get-transaction-information) 响应参数中的所有字段，此外还包含以下字段：  - `acquiring_type`: 收款类型。`Order` 表示订单模式。 - `order_id`: 支付订单 ID。 - `psp_order_code`: 您的系统中用于标识该订单的唯一标识符。                                                                                                                      |
| 充值模式 | `payment.transaction.created`            | 充值地址检测到有新的充币交易。                                                                                                                                                                                   | 该数据结构包含了 [Get transaction information](https://www.cobo.com/developers/v2/api-references/transactions/get-transaction-information) 响应参数中的所有字段，此外还包含以下字段：  - `acquiring_type`: 收款类型。`TopUp` 表示充值模式。 - `payer_id`: Cobo 分配的用于跟踪和识别付款人的唯一标识符。 - `custom_payer_id`: 您的系统中用于跟踪和识别付款人的唯一标识符。                                                                                                 |
|      | `payment.transaction.completed`          | 充币交易通过合规扫描，资金已成功入账并计入实收金额。<br /><br />订单模式下，一笔订单在有效期内收到的每笔交易也会触发此事件通知。                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                        |
| 意外入账 | `payment.transaction.external.created`   | 检测到有新的在订单/充值计划外收到的、或其他非支付服务支持接收的币种的充币交易。                                                                                                                                                          | 该数据结构包含了 [Get transaction information](https://www.cobo.com/developers/v2/api-references/transactions/get-transaction-information) 响应参数中的所有字段，此外还包含以下字段：  - `acquiring_type`: 收款类型。`External` 表示意外入账。                                                                                                                                                                                  |
|      | `payment.transaction.external.completed` | 在订单/充值计划外收到的充币交易，或其他非支付服务支持接收的币种的充币交易，通过合规扫描后，资金已成功入账并计入实收金额。                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                        |
| 入账检查 | `payment.transaction.failed`             | 充币交易合规扫描不通过。                                                                                                                                                                                      | 该数据结构包含了 [Get transaction information](https://www.cobo.com/developers/v2/api-references/transactions/get-transaction-information) 响应参数中的所有字段，此外还包含以下字段：  - `acquiring_type`: 收款类型。`Order` 表示订单模式，`TopUp` 表示充值模式。`External` 表示意外入账。 - `order_id`: 支付订单 ID。 - `psp_order_code`: 您的系统中用于标识该订单的唯一标识符。 - `payer_id`: Cobo 分配的用于跟踪和识别付款人的唯一标识符。 - `custom_payer_id`: 您的系统中用于跟踪和识别付款人的唯一标识符。 |

**2. 出账相关**

| 功能场景      | 事件名称                                            | 触发条件                                                                                                                                                                        | 事件内容                                                                                                                     |
| :-------- | :---------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------- |
| 退款        | `payment.refund.status.updated`                 | 退款单状态发生变更，会触发的节点包括：<br />- `Pending`：此状态通知仅限于通过退款链接成功创建退款单时触发。<br />- `Completed`: 所有退款交易均已完成。<br />- `PartiallyCompleted`: 部分退款交易已完成，部分退款交易失败。<br />- `Failed`: 所有退款交易均失败。 | 请参考 [Get refund order information](/payments/en/api-references/payment/get-refund-order-information) 的响应参数说明             |
| 单目的地出金/转账 | `payment.settlement.status.updated`<br />(即将废弃） | 出金/转账请求状态变更，会触发的节点包括：<br />- `Completed`: 所有出金/转账已完成。<br />- `PartiallyCompleted`: 部分出金/转账已完成，部分出金/转账失败。<br />- `Failed`: 所有出金/转账均失败。                                       | 请参考 [Get settlement request information](/payments/en/api-references/payment/get-settlement-request-information) 的响应参数说明 |
|           | `payment.payout.status.updated`                 | 出金/转账请求状态变更，会触发的节点包括：<br />- `Completed`: 所有出金/转账已完成。<br />- `PartiallyCompleted`: 部分出金/转账已完成，部分出金/转账失败。<br />- `Failed`: 所有出金/转账均失败。                                       | 请参考 [Get payout information](/payments/en/api-references/payment/get-payout-information) 的响应参数说明                         |
| 批量下发数币    | `payment.bulk_send.status.updated`              | 批量下发请求状态变更，会触发的节点包括：<br />- `Completed`: 所有下发已完成。<br />- `PartiallyCompleted`: 部分下发已完成，部分下发失败。<br />- `Failed`: 所有下发均失败。                                                    | 请参考 [Get bulk send information](/payments/en/api-references/payment/get-bulk-send-information) 的响应参数说明                   |

## 提示

为了保证数据的绝对准确性并避免并发冲突，Webhook 消息体中不会包含实时余额变动和详细扣费信息。如果您存在以下使用场景，请参考此提示说明：

1. 若需要根据每一笔终态的webhook通知 及时更新余额记账，您可以：

   a. 在接收到Webhook时，立即调用[List merchant balances](/payments/en/api-references/payment/list-merchant-balances) 或 [Get developer balances](/payments/en/api-references/payment/get-developer-balance) 获得准确的余额信息，再进行内部记账。
2. 若需要及时知道每一笔终态的Webhook引发的扣费信息、和fee station余额的变动情况，以便于关联交易和扣费方便后续对账，并保证不因fee station欠费影响业务，您可以：

   a. 使用对应功能的**查询交易信息接口 **和 [Generate reports](/payments/en/api-references/payment/generate-reports) 获取报表，来做扣费数据的核对。

   b. 定期调用 [List Fee Station token blance](/payments/cn/guides/wallet-fee-deduction) 查询fee station余额，并根据业务的消耗频率做内部报警策略，避免欠费交易的发生

<Tip>
  欢迎您[提交反馈](https://forms.zohopublic.com/cobo/form/DocumentFeedbackForm/formperma/QvLOhxJv1_JMsJ-1dleZ8Itb_7rzN-LtgvsDdxosoVI)来帮助改进我们的文档！
</Tip>